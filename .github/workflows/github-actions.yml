name: Build Test and deploy
run-name: ${{ github.actor }} is building and testing the emulator! ðŸš€
on: [push]
env:
  CARGO_TERM_COLOR: always
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Display pre-built files
        run: |
          ls ${{ github.workspace }} -la
      - name: Compile the rust files
        run: |
          cargo build
      - name: Display built files
        run: |
          ls ${{ github.workspace }}/target/debug
      - name: Archive code build results
        uses: actions/upload-artifact@v4
        with:
          name: rbgb
          path: target/debug/*

  test:
    needs: [build]
    runs-on: ubuntu-latest
    steps:
    - name: Download a single artifact
      uses: actions/download-artifact@v4
      with:
        name: rbgb-build
    - name: Pass linter
      run: |
        cargo clippy -- -Dwarnings
    - name: Run unit tests
      run: |
        cargo test

  deploy:
    needs: [build]
    runs-on: ubuntu-latest
    steps:
      - name: Placeholder for deployment to device
        run: |
          echo "TEST :)"


